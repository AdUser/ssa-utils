#include "../tests.h"

uint8_t test_1_in[81] = \
{ 0xff, 0xd8, 0xff, 0xe0, 0x00, 0x10, 0x4a, 0x46, 0x49, 0x46, 0x00, 0x01,
  0x02, 0x01, 0x00, 0x48, 0x00, 0x48, 0x00, 0x00, 0xff, 0xe1, 0x0d, 0xff,
  0x45, 0x78, 0x69, 0x66, 0x00, 0x00, 0x4d, 0x4d, 0x00, 0x2a, 0x00, 0x00,
  0x00, 0x08, 0x00, 0x07, 0x01, 0x12, 0x00, 0x03, 0x00, 0x00, 0x00, 0x01,
  0x00, 0x01, 0x00, 0x00, 0x01, 0x1a, 0x00, 0x05, 0x00, 0x00, 0x00, 0x01 };

uint8_t test_1_out[81] = \
{ 0x60, 0x5e, 0x44, 0x60, 0x59, 0x21, 0x21, 0x31, 0x33, 0x45, 0x3a, 0x2a,
  0x32, 0x41, 0x21, 0x22, 0x21, 0x41, 0x25, 0x21, 0x33, 0x21, 0x22, 0x29,
  0x21, 0x21, 0x24, 0x60, 0x59, 0x31, 0x58, 0x60, 0x32, 0x38, 0x42, 0x4a,
  0x3a, 0x41, 0x21, 0x21, 0x34, 0x35, 0x55, 0x21, 0x2b, 0x41, 0x21, 0x21,
  0x21, 0x21, 0x41, 0x21, 0x22, 0x51, 0x25, 0x33, 0x21, 0x21, 0x2d, 0x21,
  0x21, 0x21, 0x21, 0x22, 0x21, 0x21, 0x25, 0x21, 0x21, 0x21, 0x25, 0x3b,
  0x21, 0x21, 0x35, 0x21, 0x21, 0x21, 0x21, 0x22                         };

int main()
{
  uint8_t src_buf[81] = { 0x0, 0x0 };
  uint8_t dst_buf[81] = { 0x0, 0x0 };

  SIGCATCH_INIT

  /* test length checks */
  assert(uue_decode_buffer(src_buf, 81) == 0);
  assert(uue_decode_buffer(src_buf, -1) == 0);

  assert(uue_encode_buffer(src_buf, 61) == 0);
  assert(uue_encode_buffer(src_buf, -1) == 0);

  /* test encode of string with various length */
  memcpy(src_buf, test_1_in,  80);
  memcpy(dst_buf, test_1_out, 80);
  src_buf[80] = 0x0;
  dst_buf[80] = 0x0;

  assert(uue_encode_buffer(src_buf, 60) == 80);
  assert(memcmp(src_buf, dst_buf, 80) == 0);

  return 0;
}
